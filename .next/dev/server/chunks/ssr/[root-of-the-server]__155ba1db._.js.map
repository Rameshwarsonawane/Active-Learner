{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sonwa/OneDrive/Documents/nextjs/lib/types.ts"],"sourcesContent":["export enum LessonStatus {\n  NOT_STARTED = 'Not Started',\n  IN_PROGRESS = 'In Progress',\n  COMPLETED = 'Completed'\n}\n\nexport interface User {\n  id: string;\n  email: string;\n  name: string;\n}\n\nexport interface Course {\n  id: string;\n  title: string;\n  description: string;\n  image: string;\n  lessonCount: number;\n}\n\nexport interface Lesson {\n  id: string;\n  courseId: string;\n  title: string;\n  content: string;\n  order: number;\n  quiz?: Quiz;\n}\n\nexport interface Quiz {\n  id: string;\n  lessonId: string;\n  title: string;\n  questions: QuizQuestion[];\n}\n\nexport interface QuizQuestion {\n  id: string;\n  question: string;\n  options: string[];\n  correctOption: number;\n}\n\nexport interface Enrollment {\n  id: string;\n  userId: string;\n  courseId: string;\n  enrolledAt: string;\n}\n\nexport interface LessonProgress {\n  id: string;\n  userId: string;\n  lessonId: string;\n  status: LessonStatus;\n  bestScore: number;\n  updatedAt: string;\n}\n\n// Fix: Added missing Badge interface used for mastery tracking and certification visualization.\nexport interface Badge {\n  id: string;\n  userId: string;\n  courseId: string;\n  title: string;\n  icon: string;\n  awardedAt: string;\n}\n\nexport type ViewPath = 'dashboard' | 'login' | 'register' | 'course-detail' | 'lesson-player' | 'courses-list';"],"names":[],"mappings":";;;;AAAO,IAAA,AAAK,sCAAA;;;;WAAA"}},
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sonwa/OneDrive/Documents/nextjs/lib/supabaseClient.ts"],"sourcesContent":["'use client';\nimport { createClient } from '@supabase/supabase-js';\nimport { User, Enrollment, LessonProgress, LessonStatus, Course, Lesson, Quiz, QuizQuestion, Badge } from './types.ts';\n\nconst SUPABASE_URL = 'https://cgacefngnxvglazqxkep.supabase.co';\nconst SUPABASE_KEY = 'sb_publishable_HxvXo1grnLRK2iMdmT7SBQ_h6S69QZA';\n\nexport const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);\n\nexport const db = {\n  getCourses: async (): Promise<Course[]> => {\n    const { data, error } = await supabase\n      .from('courses')\n      .select('*')\n      .order('created_at', { ascending: true });\n    \n    if (error) throw error;\n    return (data || []).map(c => ({\n      id: c.id,\n      title: c.title,\n      description: c.description,\n      image: c.image,\n      lessonCount: c.lesson_count\n    }));\n  },\n\n  getCourseDetails: async (id: string) => {\n    const { data: course, error: cErr } = await supabase\n      .from('courses')\n      .select('*')\n      .eq('id', id)\n      .single();\n\n    const { data: lessons, error: lErr } = await supabase\n      .from('lessons')\n      .select('*')\n      .eq('course_id', id)\n      .order('lesson_order', { ascending: true });\n\n    if (cErr || lErr) throw (cErr || lErr);\n    \n    const mappedLessons: Lesson[] = (lessons || []).map(l => ({\n      id: l.id,\n      courseId: l.course_id,\n      title: l.title,\n      content: l.content,\n      order: l.lesson_order\n    }));\n\n    return { \n      course: {\n        id: course.id,\n        title: course.title,\n        description: course.description,\n        image: course.image,\n        lessonCount: course.lesson_count\n      }, \n      lessons: mappedLessons \n    };\n  },\n\n  getLesson: async (id: string): Promise<Lesson | null> => {\n    const { data: lessonData, error: lErr } = await supabase\n      .from('lessons')\n      .select('*')\n      .eq('id', id)\n      .single();\n    \n    if (lErr || !lessonData) return null;\n\n    const { data: quizData, error: qErr } = await supabase\n      .from('quizzes')\n      .select('*')\n      .eq('lesson_id', id)\n      .maybeSingle();\n\n    let mappedQuiz: Quiz | undefined = undefined;\n\n    if (quizData) {\n      const { data: questionsData, error: qnErr } = await supabase\n        .from('questions')\n        .select('*')\n        .eq('quiz_id', quizData.id);\n\n      if (!qnErr && questionsData && questionsData.length > 0) {\n        mappedQuiz = {\n          id: quizData.id,\n          lessonId: quizData.lesson_id,\n          title: quizData.title || 'Lesson Quiz',\n          questions: questionsData.map(q => ({\n            id: q.id,\n            question: q.question || q.question_text || 'Untitled Question',\n            options: q.options || [],\n            correctOption: q.correct_option !== undefined ? q.correct_option : q.correct_option_index\n          }))\n        };\n      }\n    }\n    \n    return {\n      id: lessonData.id,\n      courseId: lessonData.course_id,\n      title: lessonData.title,\n      content: lessonData.content,\n      order: lessonData.lesson_order,\n      quiz: mappedQuiz\n    };\n  },\n\n  getEnrollments: async (userId: string): Promise<Enrollment[]> => {\n    const { data, error } = await supabase\n      .from('enrollments')\n      .select('*')\n      .eq('user_id', userId);\n    if (error) throw error;\n    return (data || []).map(e => ({\n      id: e.id,\n      userId: e.user_id,\n      courseId: e.course_id,\n      enrolledAt: e.enrolled_at\n    }));\n  },\n\n  enroll: async (userId: string, courseId: string) => {\n    await supabase.from('enrollments').upsert([{ user_id: userId, course_id: courseId }], { onConflict: 'user_id,course_id' });\n  },\n\n  getProgress: async (userId: string): Promise<LessonProgress[]> => {\n    const { data, error } = await supabase.from('lesson_progress').select('*').eq('user_id', userId);\n    if (error) throw error;\n    return (data || []).map(p => ({\n      id: p.id,\n      userId: p.user_id,\n      lessonId: p.lesson_id,\n      status: p.status as LessonStatus,\n      bestScore: p.best_score,\n      updatedAt: p.updated_at\n    }));\n  },\n\n  getBadges: async (userId: string): Promise<Badge[]> => {\n    const { data, error } = await supabase\n      .from('badges')\n      .select('*')\n      .eq('user_id', userId);\n    \n    if (error) return [];\n    \n    return (data || []).map(b => ({\n      id: b.id,\n      userId: b.user_id,\n      courseId: b.course_id,\n      title: b.title,\n      icon: b.icon,\n      awardedAt: b.awarded_at\n    }));\n  },\n\n  awardBadgeIfComplete: async (userId: string, courseId: string): Promise<Badge | null> => {\n    try {\n      // 1. Verify all lessons are actually completed\n      const { data: allLessons, error: lErr } = await supabase.from('lessons').select('id').eq('course_id', courseId);\n      if (lErr || !allLessons || allLessons.length === 0) return null;\n\n      const { data: completedProgress, error: pErr } = await supabase\n        .from('lesson_progress')\n        .select('lesson_id')\n        .eq('user_id', userId)\n        .eq('status', LessonStatus.COMPLETED)\n        .in('lesson_id', allLessons.map(l => l.id));\n\n      if (pErr || !completedProgress || completedProgress.length !== allLessons.length) {\n        return null;\n      }\n\n      // 2. Get course info for the badge\n      const { data: course, error: cErr } = await supabase.from('courses').select('title').eq('id', courseId).single();\n      if (cErr || !course) return null;\n\n      let icon = 'üèÜ';\n      const titleLower = course.title.toLowerCase();\n      if (titleLower.includes('react')) icon = '‚öõÔ∏è';\n      else if (titleLower.includes('supabase')) icon = '‚ö°';\n      else if (titleLower.includes('ai')) icon = 'ü§ñ';\n\n      // 3. Check if badge already exists to avoid upsert/constraint errors\n      const { data: existingBadge } = await supabase\n        .from('badges')\n        .select('*')\n        .eq('user_id', userId)\n        .eq('course_id', courseId)\n        .maybeSingle();\n\n      if (existingBadge) {\n        return {\n          id: existingBadge.id,\n          userId: existingBadge.user_id,\n          courseId: existingBadge.course_id,\n          title: existingBadge.title,\n          icon: existingBadge.icon,\n          awardedAt: existingBadge.awarded_at\n        };\n      }\n\n      // 4. Create new badge\n      const badgeData = {\n        user_id: userId,\n        course_id: courseId,\n        title: `${course.title} Master`,\n        icon: icon,\n        awarded_at: new Date().toISOString()\n      };\n\n      const { data: newBadge, error: bErr } = await supabase\n        .from('badges')\n        .insert([badgeData])\n        .select()\n        .single();\n      \n      if (bErr) throw bErr;\n      \n      return {\n        id: newBadge.id,\n        userId: newBadge.user_id,\n        courseId: newBadge.course_id,\n        title: newBadge.title,\n        icon: newBadge.icon,\n        awardedAt: newBadge.awarded_at\n      };\n    } catch (err: any) {\n      console.error(\"Badge award check failed:\", err?.message || err);\n      return null;\n    }\n  },\n\n  updateProgress: async (userId: string, lessonId: string, status: LessonStatus, score: number = 0): Promise<Badge | null> => {\n    try {\n      const { data: existing } = await supabase\n        .from('lesson_progress')\n        .select('*')\n        .eq('user_id', userId)\n        .eq('lesson_id', lessonId)\n        .maybeSingle();\n\n      if (existing) {\n        await supabase.from('lesson_progress').update({\n          status,\n          best_score: Math.max(existing.best_score || 0, score),\n          updated_at: new Date().toISOString()\n        }).eq('id', existing.id);\n      } else {\n        await supabase.from('lesson_progress').insert([{\n          user_id: userId,\n          lesson_id: lessonId,\n          status,\n          best_score: score,\n          updated_at: new Date().toISOString()\n        }]);\n      }\n\n      if (status === LessonStatus.COMPLETED) {\n        const { data: lesson } = await supabase.from('lessons').select('course_id').eq('id', lessonId).single();\n        if (lesson) {\n          return await db.awardBadgeIfComplete(userId, lesson.course_id);\n        }\n      }\n    } catch (err: any) {\n      console.error(\"Update progress failed:\", err?.message || err);\n    }\n    return null;\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 240, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sonwa/OneDrive/Documents/nextjs/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { User, Course, Enrollment, LessonProgress, LessonStatus, Badge, Lesson } from '../lib/types';\nimport { db, supabase } from '../lib/supabaseClient';\n\nexport default function Page() {\n  const [user, setUser] = useState<User | null>(null);\n\n  useEffect(() => {\n    setUser({ id: 'u1', name: 'Learner', email: 'test@example.com' });\n  }, []);\n\n  const handleSelectCourse = (id: string) => {\n    console.log(\"Selected Course:\", id);\n  };\n\n  if (!user) {\n    return (\n      <div className=\"flex items-center justify-center h-screen bg-[#002b36]\">\n        <div className=\"animate-spin text-[#268bd2] text-3xl\">\n          <i className=\"fa-solid fa-circle-notch\"></i>\n        </div>\n      </div>\n    );\n  }\n\n  return <Dashboard user={user} onSelectCourse={handleSelectCourse} />;\n}\n\nconst Dashboard: React.FC<{ \n  user: User, \n  onSelectCourse: (id: string) => void \n}> = ({ user, onSelectCourse }) => {\n  const [courses, setCourses] = useState<Course[]>([]);\n  const [enrollments, setEnrollments] = useState<Enrollment[]>([]);\n  const [progress, setProgress] = useState<LessonProgress[]>([]);\n  const [badges, setBadges] = useState<Badge[]>([]);\n  const [allLessons, setAllLessons] = useState<Lesson[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [isSyncing, setIsSyncing] = useState(false);\n\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      const [c, e, p, b] = await Promise.all([\n        db.getCourses(),\n        db.getEnrollments(user.id),\n        db.getProgress(user.id),\n        db.getBadges(user.id)\n      ]);\n      \n      setCourses(c);\n      setEnrollments(e);\n      setProgress(p);\n      setBadges(b);\n\n      const { data: lessonData } = await supabase.from('lessons').select('*');\n      if (lessonData) {\n        setAllLessons(lessonData.map(l => ({\n          id: l.id,\n          courseId: l.course_id,\n          title: l.title,\n          content: l.content,\n          order: l.lesson_order\n        })));\n      }\n    } catch (err) {\n      console.error(\"Error loading dashboard:\", err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, [user.id]);\n\n  const syncBadges = async () => {\n    if (enrollments.length === 0 || allLessons.length === 0) return;\n    setIsSyncing(true);\n    let changed = false;\n    try {\n      for (const enrollment of enrollments) {\n        const hasBadge = badges.some(b => b.courseId === enrollment.courseId);\n        if (!hasBadge) {\n          const courseLessons = allLessons.filter(l => l.courseId === enrollment.courseId);\n          if (courseLessons.length > 0) {\n            const completedInCourse = progress.filter(p => \n              p.status === LessonStatus.COMPLETED && \n              courseLessons.some(cl => cl.id === p.lessonId)\n            );\n            if (completedInCourse.length === courseLessons.length) {\n              const awarded = await db.awardBadgeIfComplete(user.id, enrollment.courseId);\n              if (awarded) changed = true;\n            }\n          }\n        }\n      }\n      if (changed) {\n        const freshBadges = await db.getBadges(user.id);\n        setBadges(freshBadges);\n      }\n    } catch (err) {\n      console.error(\"Badge sync failed:\", err);\n    } finally {\n      setIsSyncing(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!loading && enrollments.length > 0 && allLessons.length > 0) {\n      syncBadges();\n    }\n  }, [loading, enrollments.length, allLessons.length]);\n\n  const getCourseStats = (courseId: string) => {\n    const courseLessons = allLessons.filter(l => l.courseId === courseId);\n    const total = courseLessons.length;\n    if (total === 0) return { completedCount: 0, total: 0, percent: 0 };\n    const completedCount = progress.filter(p => \n      p.status === LessonStatus.COMPLETED && \n      courseLessons.some(cl => cl.id === p.lessonId)\n    ).length;\n    return {\n      completedCount,\n      total,\n      percent: Math.min(100, Math.round((completedCount / total) * 100))\n    };\n  };\n\n  const enrolledCourses = enrollments.map(e => courses.find(c => c.id === e.courseId)).filter(Boolean) as Course[];\n  const completedLessons = progress.filter(p => p.status === LessonStatus.COMPLETED);\n  const averageScore = completedLessons.length > 0 \n    ? Math.round(completedLessons.reduce((acc, curr) => acc + curr.bestScore, 0) / completedLessons.length) \n    : 0;\n\n  if (loading) return (\n    <div className=\"flex items-center justify-center h-[50vh]\">\n      <div className=\"flex flex-col items-center gap-4\">\n        <i className=\"fa-solid fa-circle-notch animate-spin text-[#268bd2] text-3xl\"></i>\n        <span className=\"text-[10px] font-bold text-[#586e75] uppercase tracking-widest\">Retrieving Progress...</span>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"max-w-5xl mx-auto p-6 md:p-12 space-y-12 pb-20 bg-[#002b36] min-h-screen\">\n      <header className=\"flex flex-col md:flex-row md:items-end justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-[#eee8d5]\">Hello, {user.name}</h1>\n          <p className=\"text-[#586e75] mt-1 font-medium italic\">welcome back.</p>\n        </div>\n        <button \n          onClick={() => { fetchData(); syncBadges(); }}\n          className=\"flex items-center gap-2 text-[10px] font-bold text-[#586e75] hover:text-[#268bd2] uppercase tracking-widest transition-colors group\"\n        >\n          <i className={`fa-solid fa-arrows-rotate ${isSyncing ? 'animate-spin' : ''}`}></i>\n          {isSyncing ? 'Syncing Achievement Data...' : 'Refresh Progress'}\n        </button>\n      </header>\n\n      <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-6\">\n        {[\n          { label: 'Lessons Completed', value: completedLessons.length },\n          { label: 'Courses Enrolled', value: enrolledCourses.length},\n          { label: 'Average Score', value: `${averageScore}%` }\n        ].map((stat, i) => (\n          <div key={i} className=\"p-6 bg-[#073642] border border-[#586e75]/20 rounded-2xl flex items-center justify-between\">\n            <div>\n              <p className=\"text-[10px] font-bold text-[#586e75] uppercase tracking-widest mb-1\">{stat.label}</p>\n              <p className=\"text-3xl font-bold text-[#eee8d5]\">{stat.value}</p>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <section>\n        <h2 className=\"text-xl font-bold text-[#eee8d5] mb-8\">My Active Courses</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n          {enrolledCourses.map(course => {\n            const stats = getCourseStats(course.id);\n            const badge = badges.find(b => b.courseId === course.id);\n            const isFinished = stats.percent === 100;\n\n            return (\n              <div \n                key={course.id} \n                onClick={() => onSelectCourse(course.id)} \n                className={`bg-[#073642] p-8 rounded-2xl border transition-all cursor-pointer relative overflow-hidden flex flex-col ${\n                  isFinished ? 'border-[#859900]/40' : 'border-[#586e75]/20 hover:border-[#268bd2]/50'\n                }`}\n              >\n                {badge && <div className=\"absolute top-4 right-4 text-3xl\">{badge.icon}</div>}\n                <h3 className=\"text-xl font-bold text-[#eee8d5] mb-2\">{course.title}</h3>\n                <p className=\"text-[#839496] text-sm mb-6 line-clamp-2\">{course.description}</p>\n                <div className=\"w-full bg-[#002b36] h-1.5 rounded-full overflow-hidden\">\n                  <div \n                    className={`h-full transition-all duration-1000 ${isFinished ? 'bg-[#859900]' : 'bg-[#268bd2]'}`}\n                    style={{ width: `${stats.percent}%` }}\n                  ></div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </section>\n    </div>\n  );\n};"],"names":[],"mappings":"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"}}]
}